<div *ngIf="jobsheets.length > 0; else elseBlock">
  <header>
    <input
      type="search"
      class="form-control"
      placeholder="Search By JobNo"
      #input
      (keyup.enter)="searchByJobNo(input.value)"
      (input)="getAll(input.value)"
    />
    <select class="form-select" aria-label="Default select example" #select (change)="filterByStatus(select.value)">
      <option selected disabled>Filter By Status</option>
      <option value="1">Open</option>
      <option value="2">Close</option>
      <option value="3">Reallocated</option>
      <option value="4">Cancelled</option>
    </select>
  </header>
  <table
    *ngFor="let sheet of jobsheets"
    cellspacing="0"
    cellpadding="0"
    style="
      border: 1px solid #000000;
      border-collapse: collapse;
      width: 90%;
      margin: 40px auto;
    "
  >
    <tbody>
      <tr style="height: 14.9pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Job No: {{ sheet.jobNo }}</span>
          </p>
        </td>
        <td
          style="
            width: 212pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Assignment Date</span>
          </p>
        </td>
        <td
          style="
            width: 39.3pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">{{
              sheet.assignmentDate | date
            }}</span>
          </p>
        </td>
      </tr>
      <tr style="height: 109.8pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
        <p style="font-size: 8pt">
          <span style="font-family: Calibri"
            >CUSTOMER: {{ sheet.customerName | titlecase }}</span
          >
          <button
          data-bs-toggle="modal"
          data-bs-target="#exampleModal"
          (click)="getCustomerDetails(sheet.customerId)"
          class="btn btn-sm btn-info"
        >
          View
        </button>
        </p>

          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >Brand: {{ sheet.brandName | titlecase }}</span
            >
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >Serial No: {{ sheet.serialNo }}</span
            >
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >Phone: {{ sheet.phoneNumber }}</span
            >
          </p>
        </td>
        <td
          style="
            width: 212pt;
            border-style: solid;
            border-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >SITE ADDRESS: {{ sheet.addressLine | titlecase }}</span
            >
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >City: {{ sheet.city | titlecase }}</span
            >
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >Street: {{ sheet.street | titlecase }}</span
            >
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri"
              >Postalcode: {{ sheet.postalCode }}</span
            >
          </p>
        </td>
        <td
          style="
            width: 39.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 12pt">
            <span style="-aw-import: ignore">
                <button routerLink="/manager/view-invoice/{{sheet.callBookingId}}" class="btn btn-outline-info" >view Invoice</button>
              &nbsp;</span>
          </p>
        </td>
      </tr>
      <tr style="height: 16pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          Service Type: {{ sheet.serviceType }}
        </td>
        <td
          style="
            width: 212pt;
            border-style: solid;
            border-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Expected Date</span>
          </p>
        </td>
        <td
          style="
            width: 39.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">{{
              sheet.expectedDate | date
            }}</span>
          </p>
        </td>
      </tr>
      <tr style="height: 17.05pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
        <strong>Engineer  {{sheet.engineerName}}</strong>
      </td>
        <td
          style="
            width: 212pt;
            border-style: solid;
            border-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Call Status</span>
          </p>
        </td>
        <td
          style="
            width: 39.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >

          <p style=""class="fs-5 blink_item"  *ngIf="sheet.callStatus == 'Open' " >
            <span style="font-family: Calibri; font-weight:bold;color:red;font-size:30px">{{   sheet.callStatus  }}</span>
          </p>

          <p style=""class="fs-5 blink_item" *ngIf="sheet.callStatus == 'reallocated'  " >
            <span style="font-family: Calibri; font-weight:bold;color:purple;font-size:30px">{{   sheet.callStatus  }}</span>
          </p>

          <p style=""class="fs-5" *ngIf="sheet.callStatus == 'Close'  " >
            <span style="font-family: Calibri; font-weight:bold;color:green;font-size:30px ;">{{   sheet.callStatus }}</span>
          </p>
            <p style=""class="fs-5"  *ngIf="sheet.callStatus == 'cancelled'  " >
              <span style="font-family: Calibri; font-weight:bold;color:black;font-size:30px">{{   sheet.callStatus  }}</span>
            </p>



        </td>
      </tr>
      <tr style="height: 16pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
        <strong>Eng. Contact No: {{sheet.engPhoneNumber}}</strong>
      </td>
        <td
          style="
            width: 212pt;
            border-style: solid;
            border-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Call Priority</span>
          </p>

        </td>
        <td
          style="
            width: 39.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            border-bottom-style: solid;
            border-bottom-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >

          <p style=""class="fs-5 blink_item" *ngIf="sheet.callPriority  > 1; else elsePriority ">
            <span style="font-family: Calibri; font-weight:bold;color:red;font-size: 30px;">{{   sheet.callPriority }}</span>
          </p>
          <ng-template #elsePriority>
          <p style=""class="fs-5" >
            <span style="font-family: Calibri; font-weight:bold;color:blue;font-size: 30px;">{{   sheet.callPriority }}</span>
          </p>
          </ng-template>


        </td>
      </tr>
      <tr style="height: 86.35pt; -aw-height-rule: exactly">
        <td
          style="
            width: 184.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">Call DESCRIPTION:</span>
          </p>
          <p style="font-size: 8pt">
            <span style="font-family: Calibri">{{
              sheet.callDescription
            }}</span>
          </p>
        </td>
        <td
          style="
            width: 212pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-right-style: solid;
            border-right-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 12pt">
            <span style="-aw-import: ignore">&nbsp;</span>
          </p>
        </td>
        <td
          style="
            width: 39.3pt;
            border-top-style: solid;
            border-top-width: 0.75pt;
            border-left-style: solid;
            border-left-width: 0.75pt;
            padding-right: 5.03pt;
            padding-left: 5.03pt;
            vertical-align: top;
          "
        >
          <p style="font-size: 12pt">
            <span style="-aw-import: ignore">&nbsp;</span>
          </p>
        </td>
      </tr>
    </tbody>
  </table>
  <hr />
</div>
<ng-template #elseBlock>
  <div class="alert alert-primary" role="alert">No Jobsheet for you yet!</div>
</ng-template>
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">
          Customer Details
        </h1>
      </div>
      <div class="modal-body">
        <h5>Name :- {{ customerDetails.fullName }}</h5>
        <h5>Fullname :- {{ customerDetails.fullName }}</h5>
        <h5>Email :- {{ customerDetails.email }}</h5>
        <h5>Gender :- {{ customerDetails.gender}}</h5>
        <h5>Contact :- {{ customerDetails.phoneNumber}}</h5>
        <h5>Username :- {{ customerDetails.username}}</h5>
        <h5>Status :- {{ customerDetails.userStatus}}</h5>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
